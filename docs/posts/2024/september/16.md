---
title: MegaLinter Grafana Dashboards
date: 2024-09-16
authors:
  - practicalli
categories:
  - practicalli
tags:
  - megalinter
  - grafana
  - dashboard
---

**Thoughts for the week**

Want to try Megalinter 8 Dashboards with Grafana this week.  A chance to learn more about creating Dashboards and if Grafana is any easier than DataDog.

!!! WARNING "Megalinter not publishing logs on Grafana yet"
    Unfortunately I havent been able to make the Megalinter API Reporter work with this journal project, Clojure CLI Config or a new megalinter-test project I created.


Health is a little better after resting over the weekend, although still have lots of symptoms.

!!! EXAMPLE "Megalinter Grafana dashboard example project"
    [:fontawesome-brands-github: Practicalli Megalinter-Test](https://github.com/practicalli/megalinter-test){target=_blank .md-button}

    NOTE: I am trying to diagnose why this project does not seem to be sending logs to Grafana.

<!-- more -->

## Grafana dashboard for megalinter

Megalinter can sent logs from linter runs to Grafana to visualise the result of runs.

[Grafana Cloud Free Tier](https://grafana.com/auth/sign-up/create-user?pg=hp&plcmt=cloud-promo&cta=create-free-account) provides 14 days of logs & metrics retention for 3 users. No credit card is required to sign up and the service is free forever.

I signed up using my GitHub account and created the [practicalli.grafana.net](https://practicalli.grafana.net/) stack URL, using the `EU Germany` deployment region as its the closest to my geographical location.

Now to add configuration to each of the Practicalli Projects

Get the Loki logs service connection URL and user name

```shell
API_REPORTER_URL=https://logs-prod-012.grafana.net/loki/api/v1/push
API_REPORTER_BASIC_AUTH_USERNAME=xxxxxx
```

Get the Prometheus metrics service connection URL and user name

```shell
API_REPORTER_METRICS_URL=https://influx-prod-24-prod-eu-west-2.grafana.net/api/v1/push/influx/write
API_REPORTER_METRICS_BASIC_AUTH_USERNAME=xxxxxxx
```

### Create Service account

Administration -> Users and Access -> Cloud Access Policies, then click on Create Access Policy

Add token to the newly created policy and use the generated token value as the password value for the Loki logs and Prometheus metrics services password

Passwords

```shell
API_REPORTER_BASIC_AUTH_PASSWORD=glc_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx=
API_REPORTER_METRICS_BASIC_AUTH_PASSWORD=glc_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx=
```

Add all environment variables to the GitHub repository that will publish megalinter statistics.

> Thought: can these be added as an Org secrets rather than Repository secrets (I dont see why not, its worth a try). It will save adding these environment variables to the 22 Practicalli projects that use MegaLinter

Add these tokens to the Practicalli GitHub Org as Org secrets: [organizations/practicalli/settings/secrets/actions](https://github.com/organizations/practicalli/settings/secrets/actions)

Create New Organization secret, providing the environment variable as the name and url, username and token as the value respectively.

The repository access could be all public repositories (no sensitive information in them or their logs) or to be suitably security paranoid use selected repositories and select each specific repository that should have access.


## Add secrets to GitHub workflow


!!! EXAMPLE "MegaLinter GitHub workflow snippet"
    ```yaml

    jobs:
      megalinter:
        name: MegaLinter
        runs-on: ubuntu-latest
        env:
          # Grafana Dashboard Connections - GitHub Organization secrets
          API_REPORTER: true
          API_REPORTER_URL: ${{ secrets.API_REPORTER_URL }}
          API_REPORTER_BASIC_AUTH_USERNAME: ${{ secrets.API_REPORTER_BASIC_AUTH_USERNAME }}
          API_REPORTER_BASIC_AUTH_PASSWORD: ${{ secrets.API_REPORTER_BASIC_AUTH_PASSWORD }}
          API_REPORTER_METRICS_URL: ${{ secrets.API_REPORTER_METRICS_URL }}
          API_REPORTER_METRICS_BASIC_AUTH_USERNAME: ${{ secrets.API_REPORTER_METRICS_BASIC_AUTH_USERNAME }}
          API_REPORTER_METRICS_BASIC_AUTH_PASSWORD: ${{ secrets.API_REPORTER_METRICS_BASIC_AUTH_PASSWORD }}
          API_REPORTER_DEBUG: false
        steps:
          - run: echo "🚀 Job automatically triggered by ${{ github.event_name }}"
          - run: echo "🐧 Job running on ${{ runner.os }} server"
          - run: echo "🐙 Using ${{ github.ref }} branch from ${{ github.repository }} repository"

    ```

After pushing changes to the Megalinter config, I do not see any data in the Grafana dashboards.

> TODO: how to tell if MegaLinter has actually pushed logs to Grafana?  Or if there is an error with the configuration?

 See the content of the API notifications in execution logs, you can define API_REPORTER_DEBUG=true


!!! EXAMPLE "Megalinter Grafana dashboard example project"
    [:fontawesome-brands-github: Practicalli Megalinter-Test](https://github.com/practicalli/megalinter-test){target=_blank .md-button}

    NOTE: I am trying to diagnose why this project does not seem to be sending logs to Grafana.


---
Thank you.

[:globe_with_meridians: Practical.li Website](https://practical.li){target=_blank .md-button}

[:fontawesome-brands-github: Practical.li GitHub Org](https://github.com/practicalli){target=_blank .md-button}
[:fontawesome-brands-github: practicalli-johnny profile](https://github.com/practicalli-johnny){target=_blank .md-button}

[:fontawesome-brands-mastodon: @practicalli@clj.social](https://clj.social/@practicalli){target=_blank .md-button}
[:fontawesome-brands-twitter: @practical_li](https://twitter.com/practcial_li){target=_blank .md-button}
